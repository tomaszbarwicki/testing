openapi: 3.0.1
info:
  title: Tractus-X EDC REST API
  description: Tractus-X EDC API Documentation
  version: 0.7.3
servers:
- url: /
paths:
  /aas/request:
    post:
      tags:
      - Data Plane Proxy API
      operationId: requestAsset
      requestBody:
        content:
          '*/*':
            schema:
              $ref: "#/components/schemas/AssetRequest"
      responses:
        default:
          description: Requests asset data
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AssetRequest"
  /business-partner-groups:
    put:
      tags:
      - Business Partner Group
      description: Updates the entry for a particular BPN
      operationId: updateEntry
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/List"
      responses:
        "204":
          description: The object was successfully updated
        "400":
          description: Request body was malformed
          content:
            application/json:
              schema:
                type: array
                example: null
                items:
                  $ref: "#/components/schemas/ApiErrorDetail"
        "404":
          description: No entry for the given BPN was found
    post:
      tags:
      - Business Partner Group
      description: Creates an entry for a particular BPN
      operationId: createEntry
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/List"
      responses:
        "204":
          description: The object was successfully created
        "400":
          description: Request body was malformed
          content:
            application/json:
              schema:
                type: array
                example: null
                items:
                  $ref: "#/components/schemas/ApiErrorDetail"
        "409":
          description: An entry already exists for that BPN
  /business-partner-groups/{bpn}:
    get:
      tags:
      - Business Partner Group
      description: Resolves all groups for a particular BPN
      operationId: resolve
      parameters:
      - name: bpn
        in: path
        description: The business partner number
        required: true
        style: simple
        explode: false
        schema:
          type: string
          example: null
      responses:
        "200":
          description: An object containing an array with the assigned groups
        "400":
          description: Request body was malformed
          content:
            application/json:
              schema:
                type: array
                example: null
                items:
                  $ref: "#/components/schemas/ApiErrorDetail"
        "404":
          description: No entry for the given BPN was found
    delete:
      tags:
      - Business Partner Group
      description: Deletes the entry for a particular BPN
      operationId: deleteEntry
      parameters:
      - name: bpn
        in: path
        description: The business partner number
        required: true
        style: simple
        explode: false
        schema:
          type: string
          example: null
      responses:
        "204":
          description: The object was successfully deleted
        "400":
          description: Request body was malformed
          content:
            application/json:
              schema:
                type: array
                example: null
                items:
                  $ref: "#/components/schemas/ApiErrorDetail"
        "404":
          description: No entry for the given BPN was found
  /instrumentation:
    get:
      tags:
      - Business Partner Group
      description: Return the entire request queue.
      operationId: getRequests
      responses:
        "200":
          description: The list of RecordedRequest objects.
          content:
            application/json:
              schema:
                type: array
                example: null
                items:
                  $ref: "#/components/schemas/RecordedRequest"
    post:
      tags:
      - Business Partner Group
      description: Adds a new RecordedRequest to the end of the queue.
      operationId: addNewRequest
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/RecordedRequestObjectObject"
      responses:
        "204":
          description: The negotiation was successfully initiated.
        "400":
          description: Request body was malformed
          content:
            application/json:
              schema:
                type: array
                example: null
                items:
                  $ref: "#/components/schemas/ApiErrorDetail"
    delete:
      tags:
      - Business Partner Group
      description: Clears the entire request queue.
      operationId: clearQueue
      responses:
        "204":
          description: The queue was successfully cleared.
  /instrumentation/count:
    get:
      tags:
      - Business Partner Group
      description: Return amount of items currently in the queue.
      operationId: count
      responses:
        default:
          description: default response
          content:
            application/json:
              schema:
                type: integer
                format: int32
                example: null
  /token:
    post:
      tags:
      - Token Refresh API
      description: Resolves all groups for a particular BPN
      operationId: refreshToken
      parameters:
      - name: grant_type
        in: query
        required: false
        style: form
        explode: true
        schema:
          type: string
          example: null
      - name: refresh_token
        in: query
        required: false
        style: form
        explode: true
        schema:
          type: string
          example: null
      - name: Authorization
        in: header
        required: false
        style: simple
        explode: false
        schema:
          type: string
          example: null
      responses:
        "200":
          description: "The access token and refresh token were updated. Expiry should\
            \ be interpreted as starting from the time of message reception, allowing\
            \ for some leeway."
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/TokenResponse"
        "400":
          description: "Request body was malformed, query parameters were missing,\
            \ etc."
          content:
            application/json:
              schema:
                type: array
                example: null
                items:
                  $ref: "#/components/schemas/ApiErrorDetail"
        "401":
          description: "The token could not be refreshed due to an authentication\
            \ error, either the refresh token or the Authorization header were invalid."
          content:
            application/json:
              schema:
                type: array
                example: null
                items:
                  $ref: "#/components/schemas/ApiErrorDetail"
  /v2/edrs:
    post:
      tags:
      - Control Plane EDR Api
      description: Initiates an EDR negotiation by handling a contract negotiation
        first and then a transfer process for a given offer and with the given counter
        part. Please note that successfully invoking this endpoint only means that
        the negotiation was initiated.
      operationId: initiateEdrNegotiation
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                empty:
                  type: boolean
                  example: null
                valueType:
                  type: string
                  example: null
                  enum:
                  - ARRAY
                  - OBJECT
                  - STRING
                  - NUMBER
                  - "TRUE"
                  - "FALSE"
                  - "NULL"
              additionalProperties:
                $ref: "#/components/schemas/ContractRequest"
              example: null
      responses:
        "200":
          description: The negotiation was successfully initiated.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/IdResponse"
        "400":
          description: Request body was malformed
          content:
            application/json:
              schema:
                type: array
                example: null
                items:
                  $ref: "#/components/schemas/ApiErrorDetail"
  /v2/edrs/request:
    post:
      tags:
      - Control Plane EDR Api
      description: Request all Edr entries according to a particular query
      operationId: requestEdrEntries
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/QuerySpec"
      responses:
        "200":
          description: The edr entries matching the query
          content:
            application/json:
              schema:
                type: array
                example: null
                items:
                  $ref: "#/components/schemas/EndpointDataReferenceEntry"
        "400":
          description: Request body was malformed
          content:
            application/json:
              schema:
                type: array
                example: null
                items:
                  $ref: "#/components/schemas/ApiErrorDetail"
  /v2/edrs/{transferProcessId}:
    delete:
      tags:
      - Control Plane EDR Api
      description: Removes an EDR entry given the transfer process ID
      operationId: removeEdrEntry
      parameters:
      - name: transferProcessId
        in: path
        required: true
        style: simple
        explode: false
        schema:
          type: string
          example: null
      responses:
        "204":
          description: EDR entry was deleted successfully
        "400":
          description: "Request was malformed, e.g. id was null"
          content:
            application/json:
              schema:
                type: array
                example: null
                items:
                  $ref: "#/components/schemas/ApiErrorDetail"
        "404":
          description: An EDR entry with the given ID does not exist
          content:
            application/json:
              schema:
                type: array
                example: null
                items:
                  $ref: "#/components/schemas/ApiErrorDetail"
  /v2/edrs/{transferProcessId}/dataaddress:
    get:
      tags:
      - Control Plane EDR Api
      description: Gets the EDR data address with the given transfer process ID
      operationId: getEdrEntryDataAddress
      parameters:
      - name: transferProcessId
        in: path
        required: true
        style: simple
        explode: false
        schema:
          type: string
          example: null
      - name: auto_refresh
        in: query
        required: false
        style: form
        explode: true
        schema:
          type: boolean
          example: null
          default: true
      responses:
        "200":
          description: The data address
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/DataAddress"
        "400":
          description: "Request was malformed, e.g. id was null"
          content:
            application/json:
              schema:
                type: array
                example: null
                items:
                  $ref: "#/components/schemas/ApiErrorDetail"
        "404":
          description: An EDR data address with the given transfer process ID does
            not exist
          content:
            application/json:
              schema:
                type: array
                example: null
                items:
                  $ref: "#/components/schemas/ApiErrorDetail"
  /v2/edrs/{transferProcessId}/refresh:
    post:
      tags:
      - Control Plane EDR Api
      description: Refreshes and returns the EDR data address with the given transfer
        process ID
      operationId: refreshEdr
      parameters:
      - name: transferProcessId
        in: path
        required: true
        style: simple
        explode: false
        schema:
          type: string
          example: null
      responses:
        "200":
          description: The data address
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/DataAddress"
        "400":
          description: "Request was malformed, e.g. id was null"
          content:
            application/json:
              schema:
                type: array
                example: null
                items:
                  $ref: "#/components/schemas/ApiErrorDetail"
        "404":
          description: An EDR data address with the given transfer process ID does
            not exist
          content:
            application/json:
              schema:
                type: array
                example: null
                items:
                  $ref: "#/components/schemas/ApiErrorDetail"
components:
  schemas:
    ApiErrorDetail:
      type: object
      properties:
        invalidValue:
          type: object
          example: null
        message:
          type: string
          example: null
        path:
          type: string
          example: null
        type:
          type: string
          example: null
      example: null
    AssetRequest:
      type: object
      properties:
        assetId:
          type: string
          example: null
        pathSegments:
          type: string
          example: null
        providerId:
          type: string
          example: null
        queryParams:
          type: string
          example: null
        transferProcessId:
          type: string
          example: null
      example: null
    CallbackAddress:
      type: object
      properties:
        '@type':
          type: string
          example: https://w3id.org/edc/v0.0.1/ns/CallbackAddress
        authCodeId:
          type: string
          example: null
        authKey:
          type: string
          example: null
        events:
          uniqueItems: true
          type: array
          example: null
          items:
            type: string
            example: null
        transactional:
          type: boolean
          example: null
        uri:
          type: string
          example: null
      example: null
    ContractRequest:
      required:
      - '@context'
      - counterPartyAddress
      - policy
      - protocol
      type: object
      properties:
        '@context':
          type: object
          example: null
        '@type':
          type: string
          example: https://w3id.org/edc/v0.0.1/ns/ContractRequest
        callbackAddresses:
          type: array
          example: null
          items:
            $ref: "#/components/schemas/CallbackAddress"
        counterPartyAddress:
          type: string
          example: null
        policy:
          $ref: "#/components/schemas/Offer"
        protocol:
          type: string
          example: null
      example:
        '@context':
          '@vocab': https://w3id.org/edc/v0.0.1/ns/
        '@type': https://w3id.org/edc/v0.0.1/ns/ContractRequest
        counterPartyAddress: http://provider-address
        protocol: dataspace-protocol-http
        policy:
          '@context': http://www.w3.org/ns/odrl.jsonld
          '@type': odrl:Offer
          '@id': offer-id
          assigner: providerId
          permission: []
          prohibition: []
          obligation: []
          target: assetId
        callbackAddresses:
        - transactional: false
          uri: http://callback/url
          events:
          - contract.negotiation
          - transfer.process
          authKey: auth-key
          authCodeId: auth-code-id
    Criterion:
      required:
      - operandLeft
      - operandRight
      - operator
      type: object
      properties:
        '@type':
          type: string
          example: https://w3id.org/edc/v0.0.1/ns/Criterion
        operandLeft:
          type: object
          example: null
        operandRight:
          type: object
          example: null
        operator:
          type: string
          example: null
      example:
        '@context':
          '@vocab': https://w3id.org/edc/v0.0.1/ns/
        '@type': Criterion
        operandLeft: fieldName
        operator: =
        operandRight: some value
    DataAddress:
      type: object
      properties:
        '@type':
          type: string
          example: https://w3id.org/edc/v0.0.1/ns/DataAddress
        type:
          type: string
          example: null
      example: null
    EndpointDataReferenceEntry:
      type: object
      properties:
        '@id':
          type: string
          example: null
        '@type':
          type: string
          example: https://w3id.org/edc/v0.0.1/ns/EndpointDataReferenceEntry
      example:
        '@context':
          '@vocab': https://w3id.org/edc/v0.0.1/ns/
        '@id': transfer-process-id
        transferProcessId: transfer-process-id
        agreementId: agreement-id
        contractNegotiationId: contract-negotiation-id
        assetId: asset-id
        providerId: provider-id
        createdAt: 1688465655
    IdResponse:
      type: object
      properties:
        '@id':
          type: string
          example: null
        createdAt:
          type: integer
          format: int64
          example: null
      example:
        '@context':
          '@vocab': https://w3id.org/edc/v0.0.1/ns/
        '@id': id-value
        createdAt: 1688465655
    JsonArray:
      type: array
      properties:
        empty:
          type: boolean
          example: null
        valueType:
          type: string
          example: null
          enum:
          - ARRAY
          - OBJECT
          - STRING
          - NUMBER
          - "TRUE"
          - "FALSE"
          - "NULL"
      example: null
      items:
        $ref: "#/components/schemas/JsonValue"
    JsonObject:
      type: object
      properties:
        empty:
          type: boolean
          example: null
        valueType:
          type: string
          example: null
          enum:
          - ARRAY
          - OBJECT
          - STRING
          - NUMBER
          - "TRUE"
          - "FALSE"
          - "NULL"
      additionalProperties:
        $ref: "#/components/schemas/JsonValue"
      example: null
    JsonValue:
      type: object
      properties:
        valueType:
          type: string
          example: null
          enum:
          - ARRAY
          - OBJECT
          - STRING
          - NUMBER
          - "TRUE"
          - "FALSE"
          - "NULL"
      example: null
    List:
      type: object
      properties:
        '@id':
          type: string
          example: null
        groups:
          uniqueItems: true
          type: array
          example: null
          items:
            type: string
            example: null
      example:
        '@context':
          tx: https://w3id.org/tractusx/v0.0.1/ns/
        '@id': tx:BPN000001234
        tx:groups:
        - group1
        - group2
        - group3
    Offer:
      required:
      - '@id'
      - assigner
      - target
      type: object
      properties:
        '@id':
          type: string
          example: null
        '@type':
          type: string
          example: http://www.w3.org/ns/odrl/2/Offer
        assigner:
          type: string
          example: null
        target:
          type: string
          example: null
      description: ODRL offer
      example:
        '@context': http://www.w3.org/ns/odrl.jsonld
        '@type': odrl:Offer
        '@id': offer-id
        assigner: providerId
        target: assetId
        permission: []
        prohibition: []
        obligation: []
    QuerySpec:
      type: object
      properties:
        '@type':
          type: string
          example: https://w3id.org/edc/v0.0.1/ns/QuerySpec
        filterExpression:
          type: array
          example: null
          items:
            $ref: "#/components/schemas/Criterion"
        limit:
          type: integer
          format: int32
          example: null
        offset:
          type: integer
          format: int32
          example: null
        sortField:
          type: string
          example: null
        sortOrder:
          type: string
          example: null
          enum:
          - ASC
          - DESC
      example:
        '@context':
          '@vocab': https://w3id.org/edc/v0.0.1/ns/
        '@type': QuerySpec
        offset: 5
        limit: 10
        sortOrder: DESC
        sortField: fieldName
        filterExpression: []
    RecordedRequest:
      type: object
      properties:
        description:
          type: string
          example: null
        failure:
          $ref: "#/components/schemas/ServiceFailure"
        input:
          type: object
          example: null
        inputMatchType:
          type: string
          example: null
          enum:
          - CLASS
          - PARTIAL
          - EXACT
        name:
          type: string
          example: null
        output:
          type: object
          example: null
      example: null
    RecordedRequestObjectObject:
      type: object
      properties:
        description:
          type: string
          example: null
        failure:
          $ref: "#/components/schemas/ServiceFailure"
        input:
          type: object
          example: null
        inputMatchType:
          type: string
          example: null
          enum:
          - CLASS
          - PARTIAL
          - EXACT
        name:
          type: string
          example: null
        output:
          type: object
          example: null
      example: null
    ServiceFailure:
      type: object
      properties:
        failureDetail:
          type: string
          example: null
        messages:
          type: array
          example: null
          items:
            type: string
            example: null
        reason:
          type: string
          example: null
          enum:
          - NOT_FOUND
          - CONFLICT
          - BAD_REQUEST
          - UNAUTHORIZED
          - UNEXPECTED
      example: null
    TokenResponse:
      type: object
      properties:
        access_token:
          type: string
          example: null
        expires:
          type: integer
          format: int64
          example: null
        refresh_token:
          type: string
          example: null
        token_type:
          type: string
          example: null
      example: null
  securitySchemes:
    Authentication:
      type: http
      description: Self-Issued ID token containing a token
      scheme: bearer
      bearerFormat: JWT